<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X√≥a Firebase Users</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #c00000;
            margin-bottom: 20px;
        }
        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .info {
            background: #d1ecf1;
            border: 2px solid #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        button {
            background: #c00000;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #900000;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .success {
            background: #d4edda;
            border: 2px solid #28a745;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .error {
            background: #f8d7da;
            border: 2px solid #dc3545;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        #log {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
        }
        .log-info { color: #0066cc; }
        .log-success { color: #28a745; }
        .log-error { color: #dc3545; }
        .log-warning { color: #ffc107; }
    </style>

    <!-- Firebase CDN -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
    <div class="container">
        <h1>üóëÔ∏è X√≥a Firebase Users</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è C·∫¢NH B√ÅO:</strong> C√¥ng c·ª• n√†y s·∫Ω x√≥a T·∫§T C·∫¢ users trong Firebase Authentication. 
            H√†nh ƒë·ªông n√†y KH√îNG TH·ªÇ HO√ÄN T√ÅC!
        </div>

        <div class="info">
            <strong>‚ÑπÔ∏è L∆∞u √Ω:</strong>
            <ul>
                <li>B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n admin c√≥ quy·ªÅn qu·∫£n l√Ω users</li>
                <li>C√¥ng c·ª• n√†y ch·ªâ x√≥a users kh·ªèi Authentication, kh√¥ng x√≥a d·ªØ li·ªáu trong Database</li>
                <li>Sau khi x√≥a, b·∫°n c√≥ th·ªÉ t·∫°o l·∫°i admin user b·∫±ng Firebase Console</li>
            </ul>
        </div>

        <div>
            <h3>B∆∞·ªõc 1: ƒêƒÉng nh·∫≠p Admin</h3>
            <input type="email" id="adminEmail" placeholder="Email admin" style="padding: 10px; width: 300px; margin-right: 10px;">
            <input type="password" id="adminPassword" placeholder="Password" style="padding: 10px; width: 200px; margin-right: 10px;">
            <button onclick="loginAdmin()">ƒêƒÉng nh·∫≠p</button>
        </div>

        <div style="margin-top: 20px;">
            <h3>B∆∞·ªõc 2: Li·ªát k√™ Users</h3>
            <button onclick="listUsers()" id="listBtn" disabled>Li·ªát k√™ t·∫•t c·∫£ users</button>
            <div id="usersList"></div>
        </div>

        <div style="margin-top: 20px;">
            <h3>B∆∞·ªõc 3: X√≥a Users</h3>
            <p><strong style="color: red;">L∆∞u √Ω: Kh√¥ng th·ªÉ x√≥a users tr·ª±c ti·∫øp t·ª´ client-side Firebase.</strong></p>
            <p>ƒê·ªÉ x√≥a users, b·∫°n c·∫ßn:</p>
            <ol>
                <li><strong>S·ª≠ d·ª•ng Firebase Console:</strong>
                    <ul>
                        <li>Truy c·∫≠p: <a href="https://console.firebase.google.com/u/0/project/ttkt-aeck-edu-vn/authentication/users" target="_blank">Firebase Console - Authentication</a></li>
                        <li>Ch·ªçn t·ª´ng user v√† click "Delete"</li>
                    </ul>
                </li>
                <li><strong>Ho·∫∑c s·ª≠ d·ª•ng Firebase Admin SDK:</strong> (C·∫ßn ch·∫°y tr√™n server-side ho·∫∑c Cloud Functions)</li>
            </ol>
            
            <div class="warning" style="margin-top: 15px;">
                <strong>üí° Gi·∫£i ph√°p t·ªët nh·∫•t:</strong> V√¨ b·∫°n ƒëang deploy tr√™n GitHub Pages (static hosting), 
                khuy·∫øn ngh·ªã x√≥a users th·ªß c√¥ng qua Firebase Console ho·∫∑c t·∫°o m·ªôt Cloud Function ƒë·ªÉ x√≥a h√†ng lo·∫°t.
            </div>
        </div>

        <div id="log"></div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC_NrfdxxhzznvpeQsAeJgwhWMf8QjQr_8",
            authDomain: "ttkt-aeck-edu-vn.firebaseapp.com",
            databaseURL: "https://ttkt-aeck-edu-vn-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "ttkt-aeck-edu-vn",
            storageBucket: "ttkt-aeck-edu-vn.firebasestorage.app",
            messagingSenderId: "1060126622642",
            appId: "1:1060126622642:web:af79af3a7d8896063a5aab",
            measurementId: "G-435BXQDSV8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        let currentUser = null;

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }

        async function loginAdmin() {
            const email = document.getElementById('adminEmail').value.trim();
            const password = document.getElementById('adminPassword').value;

            if (!email || !password) {
                alert('Vui l√≤ng nh·∫≠p email v√† password');
                return;
            }

            try {
                log('ƒêang ƒëƒÉng nh·∫≠p...', 'info');
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                currentUser = userCredential.user;
                log(`‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng: ${currentUser.email}`, 'success');
                document.getElementById('listBtn').disabled = false;
            } catch (error) {
                log(`‚ùå L·ªói ƒëƒÉng nh·∫≠p: ${error.message}`, 'error');
                alert('ƒêƒÉng nh·∫≠p th·∫•t b·∫°i: ' + error.message);
            }
        }

        async function listUsers() {
            if (!currentUser) {
                alert('Vui l√≤ng ƒëƒÉng nh·∫≠p tr∆∞·ªõc');
                return;
            }

            try {
                log('ƒêang l·∫•y danh s√°ch users...', 'info');
                
                // Note: Client-side Firebase SDK kh√¥ng th·ªÉ list t·∫•t c·∫£ users
                // Ch·ªâ c√≥ th·ªÉ l·∫•y th√¥ng tin c·ªßa current user
                log('‚ö†Ô∏è Client-side SDK ch·ªâ c√≥ th·ªÉ xem current user', 'warning');
                log(`Current user: ${currentUser.email} (UID: ${currentUser.uid})`, 'info');
                
                const usersList = document.getElementById('usersList');
                usersList.innerHTML = `
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-top: 10px;">
                        <strong>Current User:</strong><br>
                        Email: ${currentUser.email}<br>
                        UID: ${currentUser.uid}<br>
                        Created: ${new Date(parseInt(currentUser.metadata.createdAt)).toLocaleString()}<br>
                        Last Login: ${new Date(parseInt(currentUser.metadata.lastLoginAt)).toLocaleString()}
                    </div>
                    <div class="info" style="margin-top: 15px;">
                        <strong>‚ÑπÔ∏è ƒê·ªÉ xem t·∫•t c·∫£ users:</strong><br>
                        Truy c·∫≠p <a href="https://console.firebase.google.com/u/0/project/ttkt-aeck-edu-vn/authentication/users" target="_blank">Firebase Console</a>
                    </div>
                `;
                
            } catch (error) {
                log(`‚ùå L·ªói: ${error.message}`, 'error');
            }
        }

        // Initialize
        log('üî• Firebase ƒë√£ kh·ªüi t·∫°o', 'info');
        log('üëâ B∆∞·ªõc 1: ƒêƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n admin', 'info');
    </script>
</body>
</html>
